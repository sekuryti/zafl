import os

Import('env')
myenv=env.Clone()
myenv.Replace(ZEST_RUNTIME=os.environ['ZEST_RUNTIME'])
myenv.Replace(AFL_PATH=os.environ['AFL_PATH'])

files="libzafl.c"

cpath='''
        $AFL_PATH/
        ../include/
        '''

myenv=myenv.Clone(CPPPATH=Split(cpath))

if int(env['autozafl']) == 1:
	lib=myenv.SharedLibrary("autozafl",  Split(files))
else:
	lib=myenv.SharedLibrary("zafl",  Split(files))

install=myenv.Install("$ZEST_RUNTIME/lib64/", lib)

Default(install)

Return('install')
